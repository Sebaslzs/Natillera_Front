<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Depósitos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1 {
            text-align: center;
        }

        form {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        label {
            display: block;
            margin-top: 10px;
        }

        input[type="text"], input[type="number"], input[type="date"] {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        button {
            margin-top: 15px;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

            button:hover {
                background-color: #45a049;
            }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>

    <h1>Gestión de Depósitos</h1>

    <!-- Formulario para agregar un nuevo depósito -->
    <form id="depositoForm">
        <input type="hidden" id="depositoID">

        <label for="ahorroID">ID del Ahorro:</label>
        <input type="number" id="ahorroID" name="ahorroID" required>

        <label for="clienteID">ID del Cliente:</label>
        <input type="number" id="clienteID" name="clienteID" required>

        <label for="monto">Monto:</label>
        <input type="number" step="0.01" id="monto" name="monto" required>

        <label for="fecha">Fecha del Depósito:</label>
        <input type="date" id="fecha" name="fecha" required>

        <button type="submit">Guardar Depósito</button>
    </form>

    <!-- Tabla para mostrar la lista de depósitos -->
    <h2>Lista de Depósitos</h2>
    <table id="depositosTable">
        <thead>
            <tr>
                <th>ID del Depósito</th>
                <th>ID del Ahorro</th>
                <th>ID del Cliente</th>
                <th>Monto</th>
                <th>Fecha</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            <!-- Aquí se insertarán dinámicamente los depósitos -->
        </tbody>
    </table>

    <script>
        const apiUrl = 'https://tu-api.com/api/depositos'; // Cambia la URL

        // Función para cargar la lista de depósitos desde la API
        async function cargarDepositos() {
            const response = await fetch(apiUrl);
            const depositos = await response.json();

            const tbody = document.querySelector("#depositosTable tbody");
            tbody.innerHTML = "";

            depositos.forEach(deposito => {
                const fila = document.createElement("tr");

                fila.innerHTML = `
                        <td>${deposito.depositoID}</td>
                        <td>${deposito.ahorroID}</td>
                        <td>${deposito.clienteID}</td>
                        <td>${deposito.monto}</td>
                        <td>${deposito.fecha}</td>
                        <td>
                            <button onclick="editarDeposito(${deposito.depositoID})">Editar</button>
                            <button onclick="eliminarDeposito(${deposito.depositoID})">Eliminar</button>
                        </td>
                    `;
                tbody.appendChild(fila);
            });
        }

        // Función para agregar o actualizar un depósito
        document.getElementById("depositoForm").addEventListener("submit", async function (event) {
            event.preventDefault();

            const depositoID = document.getElementById("depositoID").value;
            const ahorroID = document.getElementById("ahorroID").value;
            const clienteID = document.getElementById("clienteID").value;
            const monto = document.getElementById("monto").value;
            const fecha = document.getElementById("fecha").value;

            const depositoData = {
                ahorroID,
                clienteID,
                monto,
                fecha
            };

            if (depositoID) {
                // Actualizar depósito
                await fetch(`${apiUrl}/${depositoID}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(depositoData)
                });
            } else {
                // Crear nuevo depósito
                await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(depositoData)
                });
            }

            // Limpiar el formulario y recargar la lista
            document.getElementById("depositoForm").reset();
            document.getElementById("depositoID").value = '';
            cargarDepositos();
        });

        // Función para cargar los datos de un depósito en el formulario para editar
        async function editarDeposito(id) {
            const response = await fetch(`${apiUrl}/${id}`);
            const deposito = await response.json();

            document.getElementById("depositoID").value = deposito.depositoID;
            document.getElementById("ahorroID").value = deposito.ahorroID;
            document.getElementById("clienteID").value = deposito.clienteID;
            document.getElementById("monto").value = deposito.monto;
            document.getElementById("fecha").value = deposito.fecha;
        }

        // Función para eliminar un depósito
        async function eliminarDeposito(id) {
            if (confirm("¿Estás seguro de que quieres eliminar este depósito?")) {
                await fetch(`${apiUrl}/${id}`, {
                    method: 'DELETE'
                });
                cargarDepositos();
            }
        }

        // Cargar la lista de depósitos cuando se cargue la página
        window.onload = cargarDepositos;
    </script>
    <script src="Scripts/Deposito.js"></script>

</body>
</html>
